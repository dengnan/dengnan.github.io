<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>滚动控制</title>
    <style>
      .blank {
        height: 100vh;
      }
    </style>
  </head>
  <body>
    <h2>标题1</h2>
    <div class="blank"></div>
    <h2>标题2</h2>
    <div class="blank"></div>
    <h2>标题3</h2>
    <div class="blank"></div>
    <h2>标题4</h2>
    <div class="blank"></div>
    <h2>标题5</h2>
    <div class="blank"></div>
    <h2>标题6</h2>
    <div class="blank"></div>
    <h2>标题7</h2>
    <div class="blank"></div>
    <h2>标题8</h2>
    <div class="blank"></div>
    <script>
      //元素在窗口内
      function isInWindows(
        element,
        offsetMarginTop = 0,
        offsetMarginBottom = 0,
      ) {
        let offsetTop = element.offsetTop; //到文档顶部距离
        let clientHeight = element.clientHeight; //元素高度
        let scrollTop = document.documentElement.scrollTop; //滚动距离
        let windowHeight = window.screen.height; //浏览器窗口高度
        let elementBottomTop = offsetTop + clientHeight; //元素底部到文档顶部距离
        if (
          offsetTop + offsetMarginTop < windowHeight + scrollTop &&
          elementBottomTop + offsetMarginBottom > scrollTop
        ) {
          return true;
        } else {
          return false;
        }
      }
      document.addEventListener("scroll", function () {
        document.querySelectorAll(".blank").forEach((element) => {
          if (isInWindows(element, 30, -30)) {
            element.style.backgroundColor = "#ddd";
          } else {
            element.style.backgroundColor = "#fff";
          }
        });
      });
    </script>
  </body>
</html>
